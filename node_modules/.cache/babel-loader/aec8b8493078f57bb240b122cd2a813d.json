{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\USER\\\\Documents\\\\flexiMoney-web-app\\\\src\\\\features\\\\services\\\\loan\\\\AgentLoan.js\";\nimport React, { useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport axios from \"axios\";\nimport { ThreeDots } from \"svg-loaders-react\";\nimport { connect } from \"react-redux\";\nimport { useCustomToast } from \"../../../components/toast/useCustomToast\";\nimport Form from \"../../../components/common/Form\";\nimport FormGroup from \"../../../components/common/FormGroup\";\nimport Input from \"../../../components/common/Input\";\nimport Select from \"../../../components/common/Select\";\nimport Submit from \"../../../components/common/Button\";\nimport validateFormData from \"../../../validation/validateFormData\";\nimport { LOAN_APPLICATION } from \"../../../utils/constants\";\nimport logo from \"../../../assets/images/flexbycico.svg\";\nexport const AgentLoan = ({\n  agentUuid\n}) => {\n  const [validationErrors, setValidationErrors] = useState({\n    errors: true\n  });\n  const [formState, setFormState] = useState({\n    loanAmount: \"\",\n    duration: \"\"\n  });\n  const [loading, setLoading] = useState(false);\n  const showToast = useCustomToast();\n  const handleOnChange = ({\n    target\n  }) => {\n    setFormState({\n      ...formState,\n      [target.name]: target.value\n    });\n  };\n  const handleOnSubmit = e => {\n    e.preventDefault();\n    const keys = Object.keys(formState);\n    const errors = validateFormData(formState, keys);\n    setValidationErrors(errors);\n    if (Object.keys(errors).length > 0) return;\n    requestLoan();\n  };\n  const requestLoan = () => {\n    setLoading(true);\n    (async function request() {\n      const {\n        loanAmount: amount,\n        duration\n      } = formState;\n      const payload = {\n        amount,\n        duration,\n        identifier: agentUuid\n      };\n      try {\n        const res = await axios.post(LOAN_APPLICATION, payload);\n\n        // setComponentToRender(\"status\")\n\n        showToast(\"Loan application was successful\", {\n          appearance: \"error\",\n          autoDismiss: true\n        });\n      } catch (e) {\n        var _e$response$data;\n        const message = ((_e$response$data = e.response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.errors[0]) || \"Loan application was unsuccessful\";\n        showToast(message, {\n          appearance: \"error\",\n          autoDismiss: true\n        });\n      } finally {\n        setLoading(false);\n      }\n    })();\n  };\n  return /*#__PURE__*/React.createElement(Form, {\n    autoComplete: \"off\",\n    title: \"Agent loan\",\n    caption: \"Complete your loan application\",\n    handleOnSubmit: handleOnSubmit,\n    logo: logo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(FormGroup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    name: \"loanAmount\",\n    label: \"Amount\",\n    placeholder: \"Enter amount\",\n    type: \"text\",\n    value: formState.loanAmount,\n    handleOnChange: handleOnChange,\n    error: validationErrors.loanAmount,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }\n  })), /*#__PURE__*/React.createElement(FormGroup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Select, {\n    name: \"duration\",\n    label: \"Duration\",\n    type: \"\",\n    value: formState.duration,\n    handleOnChange: handleOnChange,\n    error: validationErrors.duration,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 11\n    }\n  }, \"Select duration\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 11\n    }\n  }, \"1 month\"))), /*#__PURE__*/React.createElement(Submit, {\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }\n  }, loading ? /*#__PURE__*/React.createElement(ThreeDots, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 40\n    }\n  }) : \"Submit\"));\n};\nAgentLoan.propTypes = {\n  AgentLoanState: PropTypes.object.isRequired,\n  setFormState: PropTypes.func.isRequired,\n  setComponentToRender: PropTypes.func.isRequired\n};\nconst mapStateToProps = state => {\n  return {\n    service: state.modal.service,\n    agentUuid: state.auth.user.uuid\n  };\n};\nexport default connect(mapStateToProps)(AgentLoan);","map":{"version":3,"names":["React","useState","PropTypes","axios","ThreeDots","connect","useCustomToast","Form","FormGroup","Input","Select","Submit","validateFormData","LOAN_APPLICATION","logo","AgentLoan","agentUuid","validationErrors","setValidationErrors","errors","formState","setFormState","loanAmount","duration","loading","setLoading","showToast","handleOnChange","target","name","value","handleOnSubmit","e","preventDefault","keys","Object","length","requestLoan","request","amount","payload","identifier","res","post","appearance","autoDismiss","_e$response$data","message","response","data","createElement","autoComplete","title","caption","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","label","placeholder","type","error","propTypes","AgentLoanState","object","isRequired","func","setComponentToRender","mapStateToProps","state","service","modal","auth","user","uuid"],"sources":["C:/Users/USER/Documents/flexiMoney-web-app/src/features/services/loan/AgentLoan.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport axios from \"axios\";\r\nimport { ThreeDots } from \"svg-loaders-react\";\r\nimport { connect } from \"react-redux\";\r\nimport { useCustomToast } from \"../../../components/toast/useCustomToast\";\r\nimport Form from \"../../../components/common/Form\";\r\nimport FormGroup from \"../../../components/common/FormGroup\";\r\nimport Input from \"../../../components/common/Input\";\r\nimport Select from \"../../../components/common/Select\";\r\nimport Submit from \"../../../components/common/Button\";\r\n\r\nimport validateFormData from \"../../../validation/validateFormData\";\r\nimport { LOAN_APPLICATION } from \"../../../utils/constants\";\r\n\r\nimport logo from \"../../../assets/images/flexbycico.svg\";\r\n\r\nexport const AgentLoan = ({ agentUuid }) => {\r\n  const [validationErrors, setValidationErrors] = useState({ errors: true });\r\n  const [formState, setFormState] = useState({ loanAmount: \"\", duration: \"\" });\r\n  const [loading, setLoading] = useState(false);\r\n  const showToast = useCustomToast()\r\n\r\n  const handleOnChange = ({ target }) => {\r\n    setFormState({ ...formState, [target.name]: target.value });\r\n  };\r\n\r\n  const handleOnSubmit = (e) => {\r\n    e.preventDefault();\r\n\r\n    const keys = Object.keys(formState);\r\n    const errors = validateFormData(formState, keys);\r\n\r\n    setValidationErrors(errors);\r\n\r\n    if (Object.keys(errors).length > 0) return;\r\n\r\n    requestLoan();\r\n  };\r\n\r\n  const requestLoan = () => {\r\n    setLoading(true);\r\n\r\n    (async function request() {\r\n      const { loanAmount: amount, duration } = formState;\r\n\r\n      const payload = { amount, duration, identifier: agentUuid };\r\n\r\n      try {\r\n        const res = await axios.post(LOAN_APPLICATION, payload);\r\n\r\n        // setComponentToRender(\"status\")\r\n\r\n        showToast(\"Loan application was successful\", {\r\n          appearance: \"error\",\r\n          autoDismiss: true,\r\n        });\r\n      } catch (e) {\r\n        const message =\r\n          e.response.data?.errors[0] || \"Loan application was unsuccessful\";\r\n\r\n        showToast(message, {\r\n          appearance: \"error\",\r\n          autoDismiss: true,\r\n        });\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    })();\r\n  };\r\n\r\n  return (\r\n    <Form\r\n      autoComplete=\"off\"\r\n      title=\"Agent loan\"\r\n      caption=\"Complete your loan application\"\r\n      handleOnSubmit={handleOnSubmit}\r\n      logo={logo}\r\n    >\r\n      <FormGroup>\r\n        <Input\r\n          name=\"loanAmount\"\r\n          label=\"Amount\"\r\n          placeholder=\"Enter amount\"\r\n          type=\"text\"\r\n          value={formState.loanAmount}\r\n          handleOnChange={handleOnChange}\r\n          error={validationErrors.loanAmount}\r\n        />\r\n      </FormGroup>\r\n      <FormGroup>\r\n        <Select\r\n          name=\"duration\"\r\n          label=\"Duration\"\r\n          type=\"\"\r\n          value={formState.duration}\r\n          handleOnChange={handleOnChange}\r\n          error={validationErrors.duration}\r\n        >\r\n          <option value=\"\">Select duration</option>\r\n          <option value=\"1\">1 month</option>\r\n        </Select>\r\n      </FormGroup>\r\n      <Submit type=\"submit\">{loading ? <ThreeDots /> : \"Submit\"}</Submit>\r\n    </Form>\r\n  );\r\n};\r\n\r\nAgentLoan.propTypes = {\r\n  AgentLoanState: PropTypes.object.isRequired,\r\n  setFormState: PropTypes.func.isRequired,\r\n  setComponentToRender: PropTypes.func.isRequired,\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n  return {\r\n    service: state.modal.service,\r\n    agentUuid: state.auth.user.uuid,\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps)(AgentLoan);\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}
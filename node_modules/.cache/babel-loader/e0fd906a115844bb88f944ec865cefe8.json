{"ast":null,"code":"// auth.js\nimport axios from '../utils/axiosInstance';\nimport setAuthToken from '../utils/setAuthToken';\nimport { setWalletBalance } from './wallet';\nconst LOGIN_API = '/users/signin';\nconst OTP_VERIFICATION_API = '/user/otpVer';\n\n// Action types\nconst START_LOGIN_USER = 'START_LOGIN_USER';\nconst START_OTP_VERIFICATION = 'START_OTP_VERIFICATION';\nconst LOGOUT_USER = 'LOGOUT_USER';\n\n// Action creators\nconst loginUser = userData => ({\n  type: START_LOGIN_USER,\n  payload: userData\n});\nconst logoutUser = () => ({\n  type: LOGOUT_USER\n});\n\n// Thunk actions\nexport const startLoginUser = (payload, history) => async dispatch => {\n  try {\n    const response = await axios.post(OTP_VERIFICATION_API, payload);\n    const {\n      data\n    } = response;\n    const token = data.data.token;\n    sessionStorage.setItem('token', token);\n    // console.log(token)\n\n    // Extract necessary data from the response\n    if (token) {\n      sessionStorage.setItem('isAuthenticated', true);\n      const authDetails = {\n        isAuthenticated: true,\n        user: {\n          ...data.data.user_info\n        },\n        bank: {\n          ...data.data.bank_info\n        },\n        has_pin: data.data.has_pin,\n        image: data.data.image\n      };\n      dispatch(loginUser(authDetails));\n      sessionStorage.setItem('user', JSON.stringify(authDetails));\n      // Use history.replace instead of history.push to replace the current entry\n      //history.replace('/overview');\n      //window.location.reload();\n    }\n\n    // Dispatch action to update the store with code\n  } catch (error) {\n    // Handle login error\n    console.error('Login error:', error);\n  }\n};\nexport const startLogout = () => dispatch => {\n  // Perform any necessary cleanup or API calls before logging out\n\n  // Clear session storage\n  sessionStorage.clear('user');\n  sessionStorage.clear('token');\n  sessionStorage.clear('balance');\n\n  // Dispatch action to logout\n  dispatch(logoutUser());\n};","map":{"version":3,"names":["axios","setAuthToken","setWalletBalance","LOGIN_API","OTP_VERIFICATION_API","START_LOGIN_USER","START_OTP_VERIFICATION","LOGOUT_USER","loginUser","userData","type","payload","logoutUser","startLoginUser","history","dispatch","response","post","data","token","sessionStorage","setItem","authDetails","isAuthenticated","user","user_info","bank","bank_info","has_pin","image","JSON","stringify","error","console","startLogout","clear"],"sources":["C:/Users/USER/Documents/flexiMoney-web-app/src/actions/auth2.js"],"sourcesContent":["// auth.js\r\nimport axios from '../utils/axiosInstance';\r\nimport setAuthToken from '../utils/setAuthToken';\r\nimport { setWalletBalance } from './wallet';\r\n\r\n\r\nconst LOGIN_API = '/users/signin';\r\nconst OTP_VERIFICATION_API = '/user/otpVer';\r\n\r\n// Action types\r\nconst START_LOGIN_USER = 'START_LOGIN_USER';\r\nconst START_OTP_VERIFICATION = 'START_OTP_VERIFICATION';\r\nconst LOGOUT_USER = 'LOGOUT_USER';\r\n\r\n// Action creators\r\nconst loginUser = (userData) => ({\r\n  type: START_LOGIN_USER,\r\n  payload: userData,\r\n});\r\n\r\n\r\n\r\nconst logoutUser = () => ({\r\n  type: LOGOUT_USER,\r\n});\r\n\r\n// Thunk actions\r\nexport const startLoginUser = (payload, history) => async (dispatch) => {\r\n  try {\r\n    const response = await axios.post(OTP_VERIFICATION_API, payload);\r\n    const { data } = response;\r\n    const token = data.data.token;\r\n    sessionStorage.setItem('token', token);\r\n    // console.log(token)\r\n\r\n\r\n    // Extract necessary data from the response\r\n    if (token) {\r\n      sessionStorage.setItem('isAuthenticated', true);\r\n      const authDetails = {\r\n        isAuthenticated: true,\r\n        user: {\r\n          ...data.data.user_info\r\n        },\r\n        bank: {\r\n          ...data.data.bank_info\r\n        },\r\n        has_pin: data.data.has_pin,\r\n        image: data.data.image,\r\n\r\n\r\n      };\r\n      dispatch(loginUser(authDetails));\r\n      sessionStorage.setItem('user', JSON.stringify(authDetails));\r\n      // Use history.replace instead of history.push to replace the current entry\r\n      //history.replace('/overview');\r\n      //window.location.reload();\r\n\r\n    }\r\n\r\n\r\n\r\n    // Dispatch action to update the store with code\r\n\r\n  } catch (error) {\r\n    // Handle login error\r\n    console.error('Login error:', error);\r\n  }\r\n};\r\n\r\n\r\n\r\nexport const startLogout = () => (dispatch) => {\r\n  // Perform any necessary cleanup or API calls before logging out\r\n\r\n  // Clear session storage\r\n  sessionStorage.clear('user');\r\n  sessionStorage.clear('token');\r\n  sessionStorage.clear('balance');\r\n\r\n  // Dispatch action to logout\r\n  dispatch(logoutUser());\r\n};\r\n"],"mappings":"AAAA;AACA,OAAOA,KAAK,MAAM,wBAAwB;AAC1C,OAAOC,YAAY,MAAM,uBAAuB;AAChD,SAASC,gBAAgB,QAAQ,UAAU;AAG3C,MAAMC,SAAS,GAAG,eAAe;AACjC,MAAMC,oBAAoB,GAAG,cAAc;;AAE3C;AACA,MAAMC,gBAAgB,GAAG,kBAAkB;AAC3C,MAAMC,sBAAsB,GAAG,wBAAwB;AACvD,MAAMC,WAAW,GAAG,aAAa;;AAEjC;AACA,MAAMC,SAAS,GAAIC,QAAQ,KAAM;EAC/BC,IAAI,EAAEL,gBAAgB;EACtBM,OAAO,EAAEF;AACX,CAAC,CAAC;AAIF,MAAMG,UAAU,GAAGA,CAAA,MAAO;EACxBF,IAAI,EAAEH;AACR,CAAC,CAAC;;AAEF;AACA,OAAO,MAAMM,cAAc,GAAGA,CAACF,OAAO,EAAEG,OAAO,KAAK,MAAOC,QAAQ,IAAK;EACtE,IAAI;IACF,MAAMC,QAAQ,GAAG,MAAMhB,KAAK,CAACiB,IAAI,CAACb,oBAAoB,EAAEO,OAAO,CAAC;IAChE,MAAM;MAAEO;IAAK,CAAC,GAAGF,QAAQ;IACzB,MAAMG,KAAK,GAAGD,IAAI,CAACA,IAAI,CAACC,KAAK;IAC7BC,cAAc,CAACC,OAAO,CAAC,OAAO,EAAEF,KAAK,CAAC;IACtC;;IAGA;IACA,IAAIA,KAAK,EAAE;MACTC,cAAc,CAACC,OAAO,CAAC,iBAAiB,EAAE,IAAI,CAAC;MAC/C,MAAMC,WAAW,GAAG;QAClBC,eAAe,EAAE,IAAI;QACrBC,IAAI,EAAE;UACJ,GAAGN,IAAI,CAACA,IAAI,CAACO;QACf,CAAC;QACDC,IAAI,EAAE;UACJ,GAAGR,IAAI,CAACA,IAAI,CAACS;QACf,CAAC;QACDC,OAAO,EAAEV,IAAI,CAACA,IAAI,CAACU,OAAO;QAC1BC,KAAK,EAAEX,IAAI,CAACA,IAAI,CAACW;MAGnB,CAAC;MACDd,QAAQ,CAACP,SAAS,CAACc,WAAW,CAAC,CAAC;MAChCF,cAAc,CAACC,OAAO,CAAC,MAAM,EAAES,IAAI,CAACC,SAAS,CAACT,WAAW,CAAC,CAAC;MAC3D;MACA;MACA;IAEF;;IAIA;EAEF,CAAC,CAAC,OAAOU,KAAK,EAAE;IACd;IACAC,OAAO,CAACD,KAAK,CAAC,cAAc,EAAEA,KAAK,CAAC;EACtC;AACF,CAAC;AAID,OAAO,MAAME,WAAW,GAAGA,CAAA,KAAOnB,QAAQ,IAAK;EAC7C;;EAEA;EACAK,cAAc,CAACe,KAAK,CAAC,MAAM,CAAC;EAC5Bf,cAAc,CAACe,KAAK,CAAC,OAAO,CAAC;EAC7Bf,cAAc,CAACe,KAAK,CAAC,SAAS,CAAC;;EAE/B;EACApB,QAAQ,CAACH,UAAU,CAAC,CAAC,CAAC;AACxB,CAAC"},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\USER\\\\Documents\\\\flexiMoney-web-app\\\\src\\\\features\\\\services\\\\walletTransfer\\\\WalletTransfer.js\";\nimport React, { useEffect, useState, useReducer } from \"react\";\nimport axios from \"../../../utils/axiosInstance\";\nimport transferReducer, { initialState } from \"./transfer-reducer\";\nimport { WALLET_TRANSFER } from \"../../../utils/constants\";\nimport WalletTransferForm from \"./WalletTransferForm\";\nimport WalletTransferStatus from \"./WalletTransferStatus\";\nimport WalletTransferSummary from \"./WalletTransferSummary\";\nimport FailedTransaction from \"../../../components/common/FailedTransaction\";\nimport { useToasts } from 'react-toast-notifications';\nimport styles from \"./WalletTransfer.module.scss\";\nexport const WalletTransfer = () => {\n  const [transferDetails, dispatch] = useReducer(transferReducer, initialState);\n  const [status, setStatus] = useState(\"form\");\n  const [successData, setSuccessData] = useState({});\n  const [loading, setLoading] = useState(false);\n  const [transactionDate, setTransactionDate] = useState(null);\n  const [agentLocation, setAgentLocation] = useState(null);\n  const [failedErrorMessage, setFailedErrorMessage] = useState('');\n  const {\n    addToast\n  } = useToasts();\n  useEffect(() => {\n    if (\"geolocation\" in navigator) {\n      navigator.geolocation.getCurrentPosition(function (position) {\n        setAgentLocation({\n          latitude: position.coords.latitude,\n          longitude: position.coords.longitude\n        });\n      });\n    }\n  }, []);\n  const getTransactionDate = date => {\n    const dateString = date.toString();\n    return dateString.slice(0, 24);\n  };\n  const handleWalletTransfer = () => {\n    setLoading(true);\n    const {\n      amount,\n      wallet_id\n    } = transferDetails;\n    const req = {\n      wallet_id,\n      amount\n    };\n    (async function transferFunds() {\n      try {\n        const res = await axios.post(WALLET_TRANSFER, req);\n        const message = res.data.message;\n        addToast(message, {\n          appearance: 'success',\n          autoDismiss: true\n        });\n        const date = new Date();\n        const transactionDate = getTransactionDate(date);\n        setTransactionDate(transactionDate);\n        setSuccessData(res.data.data);\n        setStatus(\"status\");\n      } catch (error) {\n        if (error.response && error.response.data.status_code === 429) {\n          setLoading(false);\n          addToast(error.response.data.message, {\n            appearance: 'error',\n            autoDismiss: true\n          });\n          setFailedErrorMessage(error.response.data.message || undefined);\n        } else if (error.response && error.response.status === 403) {\n          setLoading(false);\n          addToast(error.response.data.message, {\n            appearance: 'error',\n            autoDismiss: true\n          });\n          setFailedErrorMessage(error.response.data.message || undefined);\n        } else if (error.response && error.response.status === 401) {\n          setLoading(false);\n          addToast(error.response.data.message, {\n            appearance: 'error',\n            autoDismiss: true\n          });\n          setFailedErrorMessage(error.response.data.message || undefined);\n        } else {\n          setTimeout(() => {\n            setStatus('failed');\n            addToast(error.response.data.message, {\n              appearance: 'error',\n              autoDismiss: true\n            });\n            setFailedErrorMessage(error.response.data.message || undefined);\n          }, 3000);\n        }\n      }\n    })();\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 5\n    }\n  }, {\n    form: /*#__PURE__*/React.createElement(WalletTransferForm, {\n      dispatch: dispatch,\n      setStatus: setStatus,\n      state: transferDetails,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 13\n      }\n    }),\n    summary: /*#__PURE__*/React.createElement(WalletTransferSummary, {\n      handleWalletTransfer: handleWalletTransfer,\n      ISloading: loading,\n      state: transferDetails,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 13\n      }\n    }),\n    status: /*#__PURE__*/React.createElement(WalletTransferStatus, {\n      date: transactionDate,\n      successData: successData,\n      setStatus: setStatus,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 13\n      }\n    }),\n    failed: /*#__PURE__*/React.createElement(FailedTransaction, {\n      message: failedErrorMessage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 19\n      }\n    })\n  }[status]);\n};\nexport default WalletTransfer;","map":{"version":3,"names":["React","useEffect","useState","useReducer","axios","transferReducer","initialState","WALLET_TRANSFER","WalletTransferForm","WalletTransferStatus","WalletTransferSummary","FailedTransaction","useToasts","styles","WalletTransfer","transferDetails","dispatch","status","setStatus","successData","setSuccessData","loading","setLoading","transactionDate","setTransactionDate","agentLocation","setAgentLocation","failedErrorMessage","setFailedErrorMessage","addToast","navigator","geolocation","getCurrentPosition","position","latitude","coords","longitude","getTransactionDate","date","dateString","toString","slice","handleWalletTransfer","amount","wallet_id","req","transferFunds","res","post","message","data","appearance","autoDismiss","Date","error","response","status_code","undefined","setTimeout","createElement","className","container","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","form","state","summary","ISloading","failed"],"sources":["C:/Users/USER/Documents/flexiMoney-web-app/src/features/services/walletTransfer/WalletTransfer.js"],"sourcesContent":["import React, { useEffect, useState, useReducer } from \"react\";\r\nimport axios from \"../../../utils/axiosInstance\";\r\nimport transferReducer, { initialState } from \"./transfer-reducer\";\r\nimport { WALLET_TRANSFER } from \"../../../utils/constants\";\r\nimport WalletTransferForm from \"./WalletTransferForm\";\r\nimport WalletTransferStatus from \"./WalletTransferStatus\";\r\nimport WalletTransferSummary from \"./WalletTransferSummary\";\r\nimport FailedTransaction from \"../../../components/common/FailedTransaction\";\r\nimport { useToasts } from 'react-toast-notifications';\r\nimport styles from \"./WalletTransfer.module.scss\";\r\n\r\nexport const WalletTransfer = () => {\r\n  const [transferDetails, dispatch] = useReducer(transferReducer, initialState);\r\n  const [status, setStatus] = useState(\"form\");\r\n  const [successData, setSuccessData] = useState({});\r\n  const [loading, setLoading] = useState(false);\r\n  const [transactionDate, setTransactionDate] = useState(null);\r\n  const [agentLocation, setAgentLocation] = useState(null);\r\n  const [failedErrorMessage, setFailedErrorMessage] = useState('');\r\n  const { addToast } = useToasts();\r\n\r\n  useEffect(() => {\r\n    if (\"geolocation\" in navigator) {\r\n      navigator.geolocation.getCurrentPosition(function (position) {\r\n        setAgentLocation({\r\n          latitude: position.coords.latitude,\r\n          longitude: position.coords.longitude,\r\n        });\r\n      });\r\n    }\r\n  }, []);\r\n\r\n  const getTransactionDate = (date) => {\r\n    const dateString = date.toString();\r\n    return dateString.slice(0, 24);\r\n  };\r\n\r\n  const handleWalletTransfer = () => {\r\n    setLoading(true);\r\n\r\n    const { amount, wallet_id } = transferDetails;\r\n\r\n    const req = {\r\n      wallet_id,\r\n      amount,\r\n    };\r\n\r\n    (async function transferFunds() {\r\n      try {\r\n        const res = await axios.post(WALLET_TRANSFER, req);\r\n        const message = res.data.message;\r\n        addToast(message, {\r\n          appearance: 'success',\r\n          autoDismiss: true,\r\n      });\r\n     \r\n        const date = new Date();\r\n        const transactionDate = getTransactionDate(date);\r\n\r\n        setTransactionDate(transactionDate);\r\n        setSuccessData(res.data.data);\r\n        setStatus(\"status\");\r\n        \r\n      } catch (error) {\r\n        if (error.response && error.response.data.status_code === 429) {\r\n          setLoading(false);\r\n          addToast(error.response.data.message, {\r\n              appearance: 'error',\r\n              autoDismiss: true,\r\n          });\r\n          setFailedErrorMessage(error.response.data.message || undefined);\r\n      } else if (error.response && error.response.status === 403) {\r\n          setLoading(false);\r\n          addToast(error.response.data.message, {\r\n              appearance: 'error',\r\n              autoDismiss: true,\r\n          });\r\n          setFailedErrorMessage(error.response.data.message || undefined);\r\n      }else if (error.response && error.response.status === 401) {\r\n        setLoading(false);\r\n        addToast(error.response.data.message, {\r\n            appearance: 'error',\r\n            autoDismiss: true,\r\n        });\r\n        setFailedErrorMessage(error.response.data.message || undefined);\r\n    }else{\r\n        setTimeout(()=>{\r\n          setStatus('failed');\r\n          addToast(error.response.data.message, {\r\n            appearance: 'error',\r\n            autoDismiss: true,\r\n        });\r\n        setFailedErrorMessage(error.response.data.message || undefined);\r\n        },3000);\r\n      }}\r\n    })();\r\n  };\r\n\r\n  return (\r\n    <div className={styles.container}>\r\n      {\r\n        {\r\n          form: (\r\n            <WalletTransferForm\r\n              dispatch={dispatch}\r\n              setStatus={setStatus}\r\n              state={transferDetails}\r\n            />\r\n          ),\r\n          summary: (\r\n            <WalletTransferSummary\r\n              handleWalletTransfer={handleWalletTransfer}\r\n              ISloading={loading}\r\n              state={transferDetails}\r\n            />\r\n          ),\r\n          status: (\r\n            <WalletTransferStatus\r\n              date={transactionDate}\r\n              successData={successData}\r\n              setStatus={setStatus}\r\n            />\r\n          ),\r\n          failed: <FailedTransaction message={failedErrorMessage} />\r\n        }[status]\r\n      }\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default WalletTransfer;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}